
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plotting/plot_segment.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/theislab/squidpy_notebooks/master?filepath=docs/source/auto_examples/plotting/plot_segment.ipynb
      :alt: Launch binder
      :width: 150 px

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plotting_plot_segment.py:

Plot segmentation masks
-----------------------

This example shows how to use :func:`squidpy.pl.spatial_segment` to plot segmentation masks
and features in :class:`anndata.AnnData`.

This plotting is useful when segmentation masks and underlying image are available.

.. seealso::

    See :ref:`sphx_glr_auto_examples_plotting_plot_scatter.py` for scatter plot.

.. GENERATED FROM PYTHON SOURCE LINES 15-20

.. code-block:: default

    import squidpy as sq

    adata = sq.datasets.mibitof()
    adata.uns["spatial"].keys()


.. GENERATED FROM PYTHON SOURCE LINES 21-25

In this dataset we have 3 unique keys, which means that there are 3 unique ```library_id```.
As detailed in :ref:`sphx_glr_auto_tutorials_tutorial_read_spatial.py`, it means that there are 3
unique field of views (FOV) in this dataset.
The information to link the library ids to the observations are stored in :attr:`adata.obs`.

.. GENERATED FROM PYTHON SOURCE LINES 25-27

.. code-block:: default

    adata.obs


.. GENERATED FROM PYTHON SOURCE LINES 28-30

Specifically, the key ```library_id``` in :attr:`adata.obs` contains the same unique values
contained in :attr:`adata.uns`. We can visualize the 3 spatial dataset with :func:`squidpy.pl.spatial_segment`.

.. GENERATED FROM PYTHON SOURCE LINES 30-32

.. code-block:: default

    sq.pl.spatial_segment(adata, color="Cluster", library_key="library_id", seg_cell_id="cell_id")


.. GENERATED FROM PYTHON SOURCE LINES 33-36

There are several parameters that can be controlled. For instance, it is possible to plot
segmentation masks as "contours", in order to visualize the underlying image.
Let's visualize it for one specific cropped FOV.

.. GENERATED FROM PYTHON SOURCE LINES 36-46

.. code-block:: default

    sq.pl.spatial_segment(
        adata,
        color="Cluster",
        library_key="library_id",
        library_id="point8",
        seg_cell_id="cell_id",
        seg_contourpx=10,
        crop_coord=[(0, 0, 300, 300)],
    )


.. GENERATED FROM PYTHON SOURCE LINES 47-50

It's also possible to add an outline to better distinguish segmentation
masks' boundaries. Furthermore, the underlying image can be removed, gray scaled
or single channels can be plotted.

.. GENERATED FROM PYTHON SOURCE LINES 50-62

.. code-block:: default

    sq.pl.spatial_segment(
        adata,
        color="Cluster",
        groups=["Fibroblast", "Epithelial"],
        library_key="library_id",
        library_id=["point8", "point16"],
        seg_cell_id="cell_id",
        seg_outline=True,
        img_channel=0,
        img_cmap="magma",
    )


.. GENERATED FROM PYTHON SOURCE LINES 63-67

If groups of observations are plotted (as above), it's possible to modify
whether to "visualize" the segmentation masks that do not belong to any selected group.
It is set as "transparent" by default (see above) but in cases where e.g. no image is present
it can be useful to visualize them nonetheless

.. GENERATED FROM PYTHON SOURCE LINES 67-78

.. code-block:: default

    sq.pl.spatial_segment(
        adata,
        color="Cluster",
        groups=["Fibroblast", "Epithelial"],
        library_key="library_id",
        seg_cell_id="cell_id",
        seg_outline=True,
        img=False,
        frameon=False,
    )


.. GENERATED FROM PYTHON SOURCE LINES 79-81

Finally, a scale bar can be added, where size and pixel units must be passed.
The size for this example are not the real values and are for purely visualization purposes.

.. GENERATED FROM PYTHON SOURCE LINES 81-91

.. code-block:: default

    sq.pl.spatial_segment(
        adata,
        color="CD68",
        library_key="library_id",
        seg_cell_id="cell_id",
        img=False,
        cmap="inferno",
        scalebar_dx=2.0,
        scalebar_kwargs={"scale_loc": "bottom", "location": "lower right"},
    )


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_plotting_plot_segment.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_segment.py <plot_segment.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_segment.ipynb <plot_segment.ipynb>`
